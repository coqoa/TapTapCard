{"version":3,"sources":["AdsConsent.ts"],"names":["native","NativeModules","RNGoogleMobileAdsConsentModule","AdsConsent","requestInfoUpdate","options","Error","debugGeography","AdsConsentDebugGeography","DISABLED","EEA","NOT_EEA","tagForUnderAgeOfConsent","testDeviceIdentifiers","deviceId","showForm","reset","getTCString","getTCModel","tcString","TCString","decode","getUserChoices","tcModel","e","TCModel","__DEV__","console","warn","activelyScanDeviceCharacteristicsForIdentification","specialFeatureOptins","has","AdsConsentSpecialFeatures","ACTIVELY_SCAN_DEVICE_CHARACTERISTICS_FOR_IDENTIFICATION","applyMarketResearchToGenerateAudienceInsights","purposeConsents","AdsConsentPurposes","APPLY_MARKET_RESEARCH_TO_GENERATE_AUDIENCE_INSIGHTS","createAPersonalisedAdsProfile","CREATE_A_PERSONALISED_ADS_PROFILE","createAPersonalisedContentProfile","developAndImproveProducts","DEVELOP_AND_IMPROVE_PRODUCTS","measureAdPerformance","MEASURE_AD_PERFORMANCE","measureContentPerformance","MEASURE_CONTENT_PERFORMANCE","selectBasicAds","SELECT_BASIC_ADS","selectPersonalisedAds","SELECT_PERSONALISED_ADS","selectPersonalisedContent","SELECT_PERSONALISED_CONTENT","storeAndAccessInformationOnDevice","STORE_AND_ACCESS_INFORMATION_ON_DEVICE","usePreciseGeolocationData","USE_PRECISE_GEOLOCATION_DATA"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-present Invertase Limited & Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this library except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { TCModel, TCString } from '@iabtcf/core';\nimport { NativeModules } from 'react-native';\nimport { AdsConsentDebugGeography } from './AdsConsentDebugGeography';\nimport { AdsConsentPurposes } from './AdsConsentPurposes';\nimport { AdsConsentSpecialFeatures } from './AdsConsentSpecialFeatures';\nimport { hasOwnProperty, isArray, isBoolean, isObject, isString } from './common';\nimport {\n  AdsConsentFormResult,\n  AdsConsentInfo,\n  AdsConsentInfoOptions,\n  AdsConsentInterface,\n  AdsConsentUserChoices,\n} from './types/AdsConsent.interface';\n\nconst native = NativeModules.RNGoogleMobileAdsConsentModule;\n\nexport const AdsConsent: AdsConsentInterface = {\n  requestInfoUpdate(options: AdsConsentInfoOptions = {}): Promise<AdsConsentInfo> {\n    if (!isObject(options)) {\n      throw new Error(\"AdsConsent.requestInfoUpdate(*) 'options' expected an object value.\");\n    }\n\n    if (\n      hasOwnProperty(options, 'debugGeography') &&\n      options.debugGeography !== AdsConsentDebugGeography.DISABLED &&\n      options.debugGeography !== AdsConsentDebugGeography.EEA &&\n      options.debugGeography !== AdsConsentDebugGeography.NOT_EEA\n    ) {\n      throw new Error(\n        \"AdsConsent.requestInfoUpdate(*) 'options.debugGeography' expected one of AdsConsentDebugGeography.DISABLED, AdsConsentDebugGeography.EEA or AdsConsentDebugGeography.NOT_EEA.\",\n      );\n    }\n\n    if (\n      hasOwnProperty(options, 'tagForUnderAgeOfConsent') &&\n      !isBoolean(options.tagForUnderAgeOfConsent)\n    ) {\n      throw new Error(\n        \"AdsConsent.requestInfoUpdate(*) 'options.tagForUnderAgeOfConsent' expected a boolean value.\",\n      );\n    }\n\n    if (hasOwnProperty(options, 'testDeviceIdentifiers')) {\n      if (!isArray(options.testDeviceIdentifiers)) {\n        throw new Error(\n          \"AdsConsent.requestInfoUpdate(*) 'options.testDeviceIdentifiers' expected an array of string values.\",\n        );\n      }\n\n      for (const deviceId of options.testDeviceIdentifiers ?? []) {\n        if (!isString(deviceId)) {\n          throw new Error(\n            \"AdsConsent.requestInfoUpdate(*) 'options.testDeviceIdentifiers' expected an array of string values.\",\n          );\n        }\n      }\n    }\n\n    return native.requestInfoUpdate(options);\n  },\n\n  showForm(): Promise<AdsConsentFormResult> {\n    return native.showForm();\n  },\n\n  reset(): void {\n    return native.reset();\n  },\n\n  getTCString(): Promise<string> {\n    return native.getTCString();\n  },\n\n  async getTCModel(): Promise<TCModel> {\n    const tcString = await native.getTCString();\n    return TCString.decode(tcString);\n  },\n\n  async getUserChoices(): Promise<AdsConsentUserChoices> {\n    const tcString = await native.getTCString();\n\n    let tcModel: TCModel;\n\n    try {\n      tcModel = TCString.decode(tcString);\n    } catch (e) {\n      tcModel = new TCModel();\n\n      if (__DEV__) {\n        // eslint-disable-next-line no-console\n        console.warn(`Failed to decode tcString ${tcString}:`, e);\n      }\n    }\n\n    return {\n      activelyScanDeviceCharacteristicsForIdentification: tcModel.specialFeatureOptins.has(\n        AdsConsentSpecialFeatures.ACTIVELY_SCAN_DEVICE_CHARACTERISTICS_FOR_IDENTIFICATION,\n      ),\n      applyMarketResearchToGenerateAudienceInsights: tcModel.purposeConsents.has(\n        AdsConsentPurposes.APPLY_MARKET_RESEARCH_TO_GENERATE_AUDIENCE_INSIGHTS,\n      ),\n      createAPersonalisedAdsProfile: tcModel.purposeConsents.has(\n        AdsConsentPurposes.CREATE_A_PERSONALISED_ADS_PROFILE,\n      ),\n      createAPersonalisedContentProfile: tcModel.purposeConsents.has(\n        AdsConsentPurposes.CREATE_A_PERSONALISED_ADS_PROFILE,\n      ),\n      developAndImproveProducts: tcModel.purposeConsents.has(\n        AdsConsentPurposes.DEVELOP_AND_IMPROVE_PRODUCTS,\n      ),\n      measureAdPerformance: tcModel.purposeConsents.has(AdsConsentPurposes.MEASURE_AD_PERFORMANCE),\n      measureContentPerformance: tcModel.purposeConsents.has(\n        AdsConsentPurposes.MEASURE_CONTENT_PERFORMANCE,\n      ),\n      selectBasicAds: tcModel.purposeConsents.has(AdsConsentPurposes.SELECT_BASIC_ADS),\n      selectPersonalisedAds: tcModel.purposeConsents.has(\n        AdsConsentPurposes.SELECT_PERSONALISED_ADS,\n      ),\n      selectPersonalisedContent: tcModel.purposeConsents.has(\n        AdsConsentPurposes.SELECT_PERSONALISED_CONTENT,\n      ),\n      storeAndAccessInformationOnDevice: tcModel.purposeConsents.has(\n        AdsConsentPurposes.STORE_AND_ACCESS_INFORMATION_ON_DEVICE,\n      ),\n      usePreciseGeolocationData: tcModel.specialFeatureOptins.has(\n        AdsConsentSpecialFeatures.USE_PRECISE_GEOLOCATION_DATA,\n      ),\n    };\n  },\n};\n"]}