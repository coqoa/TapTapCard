{"version":3,"sources":["ValidationForPayment.ts"],"names":["Validation","IMPConst","ValidationForPayment","constructor","userCode","loading","callback","data","validateCallback","undefined","isValid","message","validateData","pg","pay_method","merchant_uid","amount","buyer_tel","app_scheme","language","digital","biz_num","customer_uid","naverPopupMode","popup","pgProvider","split","PG","indexOf","EN_AVAILABLE_PG","includes","LANGUAGE"],"mappings":"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","sourcesContent":["import { Validation, IMPData } from './Validation';\nimport { IMPConst } from '../constants';\n\nclass ValidationForPayment extends Validation {\n  constructor(\n    userCode: string,\n    loading: object,\n    callback: (response: any) => any,\n    data: IMPData.PaymentData,\n  ) {\n    super(userCode, loading, callback, data);\n  }\n\n  validateCallback() {\n    if (this.callback !== undefined && typeof this.callback !== 'function') {\n      this.isValid = false;\n      this.message = '콜백 함수(callback)가 올바르지 않습니다.';\n      return;\n    }\n    this.validateData();\n  }\n\n  validateData() {\n    const {\n      pg,\n      pay_method,\n      merchant_uid,\n      amount,\n      buyer_tel,\n      app_scheme,\n      language,\n      digital,\n      biz_num,\n      customer_uid,\n      naverPopupMode,\n      popup,\n    } = <IMPData.PaymentData>this.data;\n\n    if (this.data === undefined) {\n      this.isValid = false;\n      this.message = '결제 파라미터(data)는 필수입력입니다.';\n      return;\n    }\n\n    if (merchant_uid === undefined) {\n      this.isValid = false;\n      this.message = '주문번호(merchant_uid)는 필수입력입니다.';\n      return;\n    }\n\n    if (amount === undefined) {\n      this.isValid = false;\n      this.message = '결제금액(amount)은 필수입력입니다.';\n      return;\n    }\n\n    if (buyer_tel === undefined) {\n      this.isValid = false;\n      this.message = '구매자 번호(buyer_tel)는 필수입력입니다.';\n      return;\n    }\n\n    if (app_scheme === undefined) {\n      this.isValid = false;\n      this.message = 'app_scheme은 필수입력입니다.';\n      return;\n    }\n\n    if (pg) {\n      const [pgProvider] = pg.split('.');\n      if (IMPConst.PG.indexOf(pgProvider as any) === -1) {\n        this.isValid = false;\n        this.message = 'PG사가 올바르지 않습니다.';\n      }\n    }\n\n    if (language && pg !== 'paypal') {\n      if (IMPConst.EN_AVAILABLE_PG.indexOf(pg as any) !== -1) {\n        if (pg === 'eximbay') {\n          if (!['ko', 'en', 'zh', 'jp'].includes(language)) {\n            this.isValid = false;\n            this.message =\n              '올바르지 않은 언어 설정입니다.\\n 선택하신 PG사는 ko, en, zh jp 옵션을 지원합니다.';\n            return;\n          }\n        } else if (IMPConst.LANGUAGE.indexOf(language as any) !== -1) {\n          this.isValid = false;\n          this.message =\n            '올바르지 않은 언어 설정입니다.\\n 선택하신 PG사는 ko 또는 en 옵션을 지원합니다.';\n          return;\n        }\n      } else if (language !== 'ko') {\n        this.isValid = false;\n        this.message =\n          '올바르지 않은 언어 설정입니다.\\n 선택하신 PG사는 ko 옵션만 지원합니다.';\n        return;\n      }\n    }\n\n    if (pay_method === 'phone' && digital === undefined) {\n      this.isValid = false;\n      this.message = '휴대폰 소액결제시 digital은 필수입력입니다.';\n      return;\n    }\n\n    if (pg === 'syrup') {\n      this.isValid = false;\n      this.message = '해당 모듈은 현재 시럽페이를 지원하지 않습니다.';\n      return;\n    }\n\n    if (pg === 'paypal' && popup) {\n      this.isValid = false;\n      this.message = '해당 모듈에서 popup은\\n페이팔 결제시 지원하지 않습니다.';\n      return;\n    }\n\n    if ((pg === 'naverpay') && naverPopupMode) {\n      this.isValid = false;\n      this.message =\n        '해당 모듈에서 popup은\\n네이버 페이 결제시 지원하지 않습니다.';\n      return;\n    }\n\n    if (\n      pg === 'danal_tpay' &&\n      pay_method === 'vbank' &&\n      biz_num === undefined\n    ) {\n      this.isValid = false;\n      this.message = '다날-가상계좌시 biz_num은 필수입력입니다.';\n      return;\n    }\n\n    if (\n      (pg === 'kcp_billing' || pg === 'syrup') &&\n      customer_uid === undefined\n    ) {\n      this.isValid = false;\n      this.message = '정기결제시 customer_uid는 필수입력입니다.';\n      return;\n    }\n  }\n}\n\nexport default ValidationForPayment;\n"]}